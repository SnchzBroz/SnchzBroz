<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Centro de Control • SanchezBroz</title>

  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/SnchzBroz/SnchzBroz/main/Nuevo%20Logo.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --bg: 0 0% 0%;
      --card: 0 0% 10% / .6;
      --card-header: 0 0% 100% / .08;
      --text: #fff;
      --radius: 14px;
      --gap: 12px;
      --pad: 16px;
      --max-w: 1600px; /* Aumentado ligeramente para acomodar 4 columnas si es necesario */
      --title: clamp(18px, 2.2vw, 28px);
    }

    *{box-sizing:border-box}
    html,body{
      height:100%; margin:0;
      font-family:'Roboto',sans-serif;
      background:hsl(var(--bg));
      color:var(--text);
      overflow-x:hidden;
    }

    /* Fondo SIEMPRE visible */
    .bg{
      position:fixed; inset:0; z-index:0;
      background:url('https://github.com/SnchzBroz/SnchzBroz/blob/main/Fondo%20PC%20Azul.png?raw=true') center/cover no-repeat;
    }
    .navbar,.wrapper,.layout{position:relative; z-index:1}

    /* Navbar */
    header.navbar{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px var(--pad);
      background:rgba(0,0,0,.55); backdrop-filter:blur(6px);
      position:sticky; top:0; z-index:10;
      border-bottom:1px solid rgba(255,255,255,.08);
    }
    .brand{display:flex; align-items:center; gap:10px}
    .brand img{width:44px;height:44px;border-radius:10px}
    .brand span{font-weight:700}

    .controls{display:flex;align-items:center;gap:10px}

    /* Widget de espectadores */
    .viewer-widget{
      display:inline-flex; align-items:center; justify-content:center;
      padding:6px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      height:36px;
    }
    .viewer-widget iframe{
      width:160px;
      height:22px;
      border:0; display:block;
    }

    /* Tarjetas pequeñas (top) */
    .wrapper{max-width:var(--max-w);margin:0 auto;padding:10px var(--pad)}
    .top-grid{display:grid;grid-template-columns:repeat(3,minmax(220px,1fr));gap:var(--gap);align-items:stretch}
    .card{background:hsla(var(--card));border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);overflow:hidden;display:flex;flex-direction:column}
    .card__header{background:hsla(var(--card-header));text-align:center;font-weight:700;font-size:var(--title);padding:10px}
    .card__body{flex:1;min-height:60px}
    .card iframe{width:100%;height:100%;border:0;display:block}

    /* Secciones grandes */
    /* Aquí definimos 4 columnas por defecto para pantallas ULTRA anchas */
    main.layout{
      display:grid; 
      grid-template-columns: repeat(4, 1fr); 
      gap:var(--gap);
      max-width:var(--max-w);
      margin:0 auto;
      padding:10px var(--pad) 24px;
    }
    
    .section{
      background:hsla(var(--card));
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      display:flex; flex-direction:column; overflow:hidden;
      min-height:78vh; /* Altura considerable */
    }
    .section__title{
      display:flex; justify-content:space-between; align-items:center;
      background:hsla(var(--card-header)); padding:6px 10px;
      min-height: 54px; /* Asegura altura uniforme del header */
    }
    .section__title img{height:40px;width:auto;max-width:100%;object-fit:contain}
    
    .section__actions button{
      background:none; border:none; cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      color: var(--text); opacity: 0.7; transition: opacity 0.2s;
    }
    .section__actions button:hover{opacity: 1;}
    .section__actions svg{width:20px;height:20px}
    
    .section__body{flex:1;min-height:0; position:relative;}
    .section__body iframe{width:100%;height:100%;border:0;display:block; position: absolute; inset: 0;}

    /* RESPONSIVE */
    
    /* Para laptops y pantallas medianas (menos de 1500px): Grid de 2x2 */
    @media (max-width:1500px){ 
      main.layout{ grid-template-columns: 1fr 1fr; } 
      .section { min-height: 50vh; } /* Reducimos altura para que quepan 2 filas */
    }

    /* Carrusel móvil: top + secciones grandes en una fila */
    @media (max-width:780px){
      .brand span{display:none}
      .top-grid{
        display:flex; overflow-x:auto; gap:var(--gap);
        scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; padding-bottom:6px;
      }
      .top-grid > .card{flex:0 0 85%; min-width:260px; scroll-snap-align:center}
      .top-grid::-webkit-scrollbar{display:none}

      main.layout{
        display:flex; overflow-x:auto; gap:var(--gap);
        scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch;
        grid-template-columns: none; /* Resetear grid */
      }
      .layout .section{
        flex:0 0 92%; 
        scroll-snap-align:center; 
        min-height:calc(100vh - 220px);
      }
    }
  </style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>

  <header class="navbar">
    <div class="brand">
      <img src="https://raw.githubusercontent.com/SnchzBroz/SnchzBroz/main/Nuevo%20Logo.png" alt="Logo" />
      <span>SanchezBroz</span>
    </div>
    <div class="controls">
      <div class="viewer-widget" aria-label="Conteo de espectadores">
        <iframe
          data-src="https://tikfinity.zerody.one/widget/viewercount?cid={{CID}}"
          loading="lazy"
          referrerpolicy="no-referrer"
          sandbox="allow-scripts allow-same-origin"
          title="Viewer Count"
        ></iframe>
      </div>
    </div>
  </header>

  <div class="wrapper">
    <section class="top-grid" aria-label="Últimos eventos">
      <article class="card" aria-label="Último Seguidor">
        <header class="card__header">Último Seguidor</header>
        <div class="card__body">
          <iframe data-src="https://tikfinity.zerody.one/widget/lastx?cid={{CID}}&x=follower" loading="lazy" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" title="Último Seguidor"></iframe>
        </div>
      </article>
      <article class="card" aria-label="Último Regalador">
        <header class="card__header">Último Regalador</header>
        <div class="card__body">
          <iframe data-src="https://tikfinity.zerody.one/widget/lastx?cid={{CID}}&x=gifter" loading="lazy" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" title="Último Regalador"></iframe>
        </div>
      </article>
      <article class="card" aria-label="Último Suscriptor">
        <header class="card__header">Último Suscriptor</header>
        <div class="card__body">
          <iframe data-src="https://tikfinity.zerody.one/widget/lastx?cid={{CID}}&x=subscriber" loading="lazy" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" title="Último Suscriptor"></iframe>
        </div>
      </article>
    </section>
  </div>

  <main class="layout" role="main">
    
    <section class="section" id="panel-likers" aria-label="Top Liker">
      <div class="section__title">
        <img src="https://raw.githubusercontent.com/SnchzBroz/SnchzBroz/main/Likers.png" alt="Top Likers" />
        <div class="section__actions">
          <button data-fs-target="#panel-likers" title="Pantalla completa" aria-label="Pantalla completa">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 9V5h4M20 15v4h-4M20 9V5h-4M4 15v4h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>
      <div class="section__body">
        <iframe data-src="https://tikfinity.zerody.one/widget/topliker?cid={{CID}}" loading="lazy" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" title="Top Likers Widget"></iframe>
      </div>
    </section>

    <section class="section" id="panel-chat" aria-label="Chat en vivo">
      <div class="section__title">
        <img src="https://raw.githubusercontent.com/SnchzBroz/SnchzBroz/refs/heads/main/Chat.png" alt="Chat" />
        <div class="section__actions">
          <button data-fs-target="#panel-chat" title="Pantalla completa" aria-label="Pantalla completa">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 9V5h4M20 15v4h-4M20 9V5h-4M4 15v4h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>
      <div class="section__body">
        <iframe 
          data-src="https://beta.socialstream.ninja/dock.html?session=sGhXvzMBGp&notime&showviewercount&nobadges&largecontent&hidemenu&transparent" 
          loading="lazy" 
          referrerpolicy="no-referrer" 
          sandbox="allow-scripts allow-same-origin allow-popups allow-forms"
          title="Social Stream Chat"
        ></iframe>
      </div>
    </section>

    <section class="section" id="panel-alertas" aria-label="Alertas">
      <div class="section__title">
        <img src="https://raw.githubusercontent.com/SnchzBroz/SnchzBroz/main/Alertas.png" alt="Alertas" />
        <div class="section__actions">
          <button data-fs-target="#panel-alertas" title="Pantalla completa" aria-label="Pantalla completa">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 9V5h4M20 15v4h-4M20 9V5h-4M4 15v4h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>
      <div class="section__body">
        <iframe data-src="https://tikfinity.zerody.one/widget/myactions?cid={{CID}}&screen=1" loading="lazy" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" title="Alertas Widget"></iframe>
      </div>
    </section>

    <section class="section" id="panel-regalos" aria-label="Regalos">
      <div class="section__title">
        <img src="https://raw.githubusercontent.com/SnchzBroz/SnchzBroz/main/Regalos.png" alt="Regalos" />
        <div class="section__actions">
          <button data-fs-target="#panel-regalos" title="Pantalla completa" aria-label="Pantalla completa">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 9V5h4M20 15v4h-4M20 9V5h-4M4 15v4h4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>
      <div class="section__body">
        <iframe data-src="https://tikfinity.zerody.one/widget/gifts?cid={{CID}}" loading="lazy" referrerpolicy="no-referrer" sandbox="allow-scripts allow-same-origin" title="Regalos Widget"></iframe>
      </div>
    </section>

  </main>

  <script>
    const CONFIG = { cid: '615689' };

    // 1. Cargar CID en todos los iframes con data-src (Lazy Load Manual)
    (function applyCid(){
      document.querySelectorAll('iframe[data-src]').forEach(f=>{
        if(!f.src) {
          // Reemplaza {{CID}} si existe, si no, deja la URL tal cual (para el Chat)
          f.src = f.dataset.src.replace('{{CID}}', CONFIG.cid);
        }
      });
    })();

    // 2. Pantalla completa básica
    (function setupFullscreen(){
      document.querySelectorAll('[data-fs-target]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const el = document.querySelector(btn.dataset.fsTarget);
          if (document.fullscreenElement) {
            document.exitFullscreen();
          } else if (el && el.requestFullscreen) {
            el.requestFullscreen();
          }
        });
      });
    })();

    // 3. Autoscroll del carrusel superior (Solo móvil)
    (function setupTopCarousel(){
      const container = document.querySelector('.top-grid');
      if (!container) return;
      
      const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      let raf; 
      const speed = 0.5;
      let isPaused = false;

      // Pausar si el usuario toca el carrusel
      container.addEventListener('touchstart', () => isPaused = true);
      container.addEventListener('touchend', () => setTimeout(() => isPaused = false, 2000));

      function tick(){
        if (window.innerWidth <= 780 && !reduce && !isPaused){
          container.scrollLeft += speed;
          // Reiniciar si llega al final
          if (container.scrollLeft + container.clientWidth >= container.scrollWidth - 1) {
            container.scrollLeft = 0;
          }
        }
        raf = requestAnimationFrame(tick);
      }
      
      raf = requestAnimationFrame(tick);
      // Detener animación si la pestaña no es visible para ahorrar recursos
      document.addEventListener('visibilitychange', ()=>{ 
        if (document.hidden) cancelAnimationFrame(raf); 
        else raf = requestAnimationFrame(tick); 
      });
    })();
  </script>
</body>
</html>
